<%@page import="java.sql.ResultSet"%>
<%@page import="com.itrium.borey.client.*"%>
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<% 
	Object userObj = session.getAttribute("user");
    if (userObj == null) {
        response.sendRedirect("index.jsp");
    }
    int user = (int) userObj;
    String email = (String) session.getAttribute("email");
    ControllerParams[] statuses = Controllers.getControllers(user, response.getWriter());
%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Information about your controllers.</title>
</head>
<body>

<body>

<h3>Information about your controllers.</h3>

<p>
User: <strong> <%= email %></strong> <br>
<a href="LogOut">Log out</a>
</p>

<% 
    for(int i = 0; i < statuses.length; i++) {
        String id = statuses[i].key;
        String time = statuses[i].time;
        String status = statuses[i].status;
        String color = "";

        switch (status) {
            case "NORMAL":
                color = "green";
                break;
            case "DISARM":
                color = "black";
                break;
            case "BREAK":
                color = "red";
                break;
            case "ALARM":
                color = "red";
                break;
            case "PART":
                color = "yellow";
                break;
        }

%>  
        <p>
        Controller ID: <strong><%= id %></strong><br>
        Last connection: <strong><%= time %></strong><br>
        Status: <strong><font color="<%= color %>"><%= status %></font></strong><br>
        </p>
<%
    }
%>

<p>
<a href="addcontroller.jsp">Add controller</a>
</p>

</body>
</html>